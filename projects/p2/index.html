<!DOCTYPE html>
<html>
<head>
	<!-- Bootstrap CDN -->
	<link rel="stylesheet" type="text/css" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css">
	<!-- CDN for the font used -->
	<link href="https://fonts.googleapis.com/css?family=Montserrat" rel="stylesheet">
	<!-- Personal CSS -->
	<style type="text/css">

		/* HTML elements */
		body
		{
			background-color: #232323;
			color: white;
			font-family: "Montserrat", "Avenir";
		}

		h1
	   	{
	   		text-align: center;
	   		padding-top: 20px;
	   	}

	   	hr
	   	{
	   		background-color: gray;
	   	}
	   	
	   	select
	   	{
	   		height: 250px;
	   		width: 300px;
	   	}

	   	button
	   	{
	   		padding: 10px;
	   		margin: 20px;
	   	}

	   	li
	   	{
	   		padding: 10px;
	   	}

	   	/* classes */
		.inactiveScreen
		{
	        display: none;
	    }

	    .square 
        {
		  width: 20px;
		  height: 10px;
		  margin: 20px;
		  padding: 15px;
		  border: 1px solid rgba(0, 0, 0, 0.2);
		}

		.searchContent
		{
			margin: 10px;
			padding: 20px;
		}

		.black 
		{
			color: black;
		}

		/* ID's */
	   	#list
	   	{
	   		background-color: rgb(52, 58, 64);
	   	}

	   	#map 
	   	{
	   		margin: 20px;
	   		padding: 20px;
        	height: 600px;
        }
        #submitBtn
        {
        	width: 20%;
        }
	</style>
	<title>akhan227 | Project 2</title>
</head>
<body>
	<!-- Home/Instructions Screen -->
	<div id="homeScreen" class="inactiveScreen">
		<!-- nav bar -->
		<nav id="homeNav" class="navbar navbar-expand-lg navbar-dark bg-dark">
			<a class="navbar-brand" href="#">HOME</a>
		  	<button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
		    	<span class="navbar-toggler-icon"></span>
		  	</button>
		  	<div class="collapse navbar-collapse" id="navbarNav">
			    <ul class="navbar-nav">
			    	<li id="homeLI" class="nav-item active">
			    		<a class="nav-link" href="#">Home<span class="sr-only">(current)</span></a>
				    </li>
				    <li id="searchLI" class="nav-item">
				        <a class="nav-link" href="#">Search</a>
				    </li>
				    <li id="mapLI" class="nav-item">
				    	<a class="nav-link" href="#">Map</a>
				    </li>
			    </ul>
		  	</div>
		</nav>
		<div class="container">
			<div id="homeContent">
				<h1>CPS Information</h1>
				<hr>
				<p>
					Welcome to our CPS school information prototype. Our goal is to provide a valuable resource for those seeking to rent or buy in Chicago. A major factor that plays into purchasing a home is the school surrounding the area. Whether prospective buyers have kids or not, Nearby schools are important to prospective buyers even if they don’t have kids yet because it speaks volumes about the community they want to enter and can also help push the conversation of having kids in the future.
				</p>
				<p>
					We appreciate you using our website and hope you could provide any sort of positive and/or negative feedback on our design!
				</p>

				<ul id="list">
					<li>Click the ‘Get Started’ button to start searching for the various school types available in Chicago.</li>
					<li>
						The search page allows you to add/remove any combination of Chicago school types to your search. 
						<ul>
							<li>Click the ‘submit’ button to display the results of your search.</li>
						</ul>
					</li>
					<li>
						The map page shows a map with markers for all the different schools in the areas you chose! 
						<ul>
							<li>To make your life easier the markers are color coded by school type. There’s also a key for you </li>
							<li>Click a marker on the map to see information about that specific school</li>
							<li>Click the ‘New Search’ to start a clean search</li>
						</ul>
					</li>
					<li>
						At any time, you can navigate to any of the other pages by simply using the navigation bar at the top of the screen. 
						<ul>
							<li>
								The screen you are on will be highlighted white, while also being displayed in all caps on the left
							</li>
						</ul>
					</li>
				</ul>
				<div style="text-align: center">
					<button id="startBtn">Get Started</button>
				</div>
			</div>
		</div>
	<!-- close home screen div -->
	</div>
	<!-- Search/Listing Screen-->
	<div id="searchScreen" class="inactiveScreen">
		<!-- nav bar -->
		<nav id="homeNav" class="navbar navbar-expand-lg navbar-dark bg-dark">
			<a class="navbar-brand" href="#">SEARCH</a>
		  	<button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
		    	<span class="navbar-toggler-icon"></span>
		  	</button>
		  	<div class="collapse navbar-collapse" id="navbarNav">
			    <ul class="navbar-nav">
			    	<li id="homeLI" class="nav-item">
			    		<a class="nav-link" href="#">Home</a>
				    </li>
				    <li id="searchLI" class="nav-item active">
				        <a class="nav-link" href="#">Search<span class="sr-only">(current)</span></a>
				    </li>
				    <li id="mapLI" class="nav-item">
				    	<a class="nav-link" href="#">Map</a>
				    </li>
			    </ul>
		  	</div>
		</nav>
		<div class="container">
			<div class="searchContent">
				<div id="selection">
					<select id="multiselect" multiple></select>
					<button id="addBtn">Add</button>
					<button id="rmvBtn">Remove</button>
					<button id="clrBtn">Clear All</button>
				</div>
				<div id="display">
					<p>Currently Selected School Types:</p>
					<textarea id="txtbox" rows="5" cols="40" readonly></textarea>
					<button id="submitBtn">SUBMIT</button>
				</div>
			</div>
		</div>
	<!-- close search screen div -->
	</div>
	<!-- Map Screen -->
	<div id="mapScreen" class="inactiveScreen">
		<!-- nav bar -->
		<nav id="homeNav" class="navbar navbar-expand-lg navbar-dark bg-dark">
			<a class="navbar-brand" href="#">MAP</a>
		  	<button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
		    	<span class="navbar-toggler-icon"></span>
		  	</button>
		  	<div class="collapse navbar-collapse" id="navbarNav">
			    <ul class="navbar-nav">
			    	<li id="homeLI" class="nav-item">
			    		<a class="nav-link" href="#">Home</a>
				    </li>
				    <li id="searchLI" class="nav-item">
				        <a class="nav-link" href="#">Search</a>
				    </li>
				    <li id="mapLI" class="nav-item active">
				    	<a class="nav-link" href="#">Map<span class="sr-only">(current)</span></a>
				    </li>
			    </ul>
		  	</div>
		</nav>
		<button id="newBtn">New Search</button>
		<br>
		<div class="container" id="colorKey">
			<div class="row">
				<div class="col-lg-3 col-md-6 col-sm-12">
					<span class="square" style="background: #FF0000"></span>Career Academy
				</div>
				<div class="col-lg-3 col-md-6 col-sm-12">
					<span class="square" style="background: #FF7F00"></span>Charter
				</div>
				<div class="col-lg-3 col-md-6 col-sm-12">
					<span class="square" style="background: #FFFF00"></span>Citywide-Option
				</div>
				<div class="col-lg-3 col-md-6 col-sm-12">
					<span class="square" style="background: #0000FF"></span>Classical
				</div>
			</div>
			<br><br>
			<div class="row">
				<div class="col-lg-3 col-md-6 col-sm-12">
					<span class="square" style="background: #9400D3"></span>Contract
				</div>
				<div class="col-lg-3 col-md-6 col-sm-12">
					<span class="square" style="background: #FFFFFF"></span>Magnet
				</div>
				<div class="col-lg-3 col-md-6 col-sm-12">
					<span class="square" style="background: #000000"></span>Military academy
				</div>
				<div class="col-lg-3 col-md-6 col-sm-12">
					<span class="square" style="background: #00FFFF"></span>Neighborhood
				</div>
			</div>
			<br><br>
			<div class="row">
				<div class="col-lg-3 col-md-6 col-sm-12">
					<span class="square" style="background: #FF99FF"></span>Regional gifted center
				</div>
				<div class="col-lg-3 col-md-6 col-sm-12">
					<span class="square" style="background: #663300"></span>Selective enrollment
				</div>
				<div class="col-lg-3 col-md-6 col-sm-12">
					<span class="square" style="background: #006600"></span>Small
				</div>
				<div class="col-lg-3 col-md-6 col-sm-12">
					<span class="square" style="background: #66ff66"></span>Special Education
				</div>
			</div>
			<br>
		</div>
		<div id="map"></div>
	<!-- close map screen div -->
	</div>
	<!-- JQuery CDN -->
	<script
		src="https://code.jquery.com/jquery-3.3.1.min.js"
		integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8="
		crossorigin="anonymous">     	
    </script>
    <!-- My Script -->
    <script type="text/javascript">
    	// variables to hold the three screens
    	var hScreen = $("#homeScreen");
    	var sScreen = $("#searchScreen");
    	var mScreen = $("#mapScreen");

    	// document ready event handler to show the home screen
    	$(document).ready(
    		function()
	    	{
		    	// show the home screen by removing the 'inactiveScreen' class
	    		$(hScreen).toggleClass("inactiveScreen");
	        });

    	// function will add event handler to the li 'listItem' that will
    	// turn the 'turnoffScreen' to inactive, 
    	// and turn the 'turnonnScreen' to active
    	function addNavActions(turnoffScreen, listItem, turnonScreen)
    	{
    		$(turnoffScreen).find(listItem).click(
    			function()
    			{
		    		$(turnoffScreen).toggleClass("inactiveScreen");
		    		$(turnonScreen).toggleClass("inactiveScreen");
		    	});
    	}

    	// add event handlers to the home screen navbar
    	addNavActions(hScreen, "#searchLI", sScreen);
    	addNavActions(hScreen, "#mapLI", mScreen);

    	// add event handlers to the home 'Get Started' button
    	addNavActions(hScreen, "#startBtn", sScreen);

    	// add event handlers to the search screen navbar
    	addNavActions(sScreen, "#homeLI", hScreen);
    	addNavActions(sScreen, "#mapLI", mScreen);

    	// add event handlers to the map screen navbar
    	addNavActions(mScreen, "#homeLI", hScreen);
    	addNavActions(mScreen, "#searchLI", sScreen);

    	// Search Stuff
    	//-------------------------------------------------------------------------------
    	// add the school type names to the select 
	    $.ajax(
	    {
	    	// the url for requesting school type data from the api
	        url: "https://data.cityofchicago.org/resource/76dk-7ieb.json?$select=school_type&$group=school_type",
	        method: 'GET',
	     }).done(function(response) 
		    {
				$.each(response, function(i, v)
				{
					var option = "<option value=\"" + v.school_type + "\">" + v.school_type + "</option>";

					$("#multiselect").append(option);
				});
		        
		    }).fail(function(err) 
			   {
			   		throw err;
		       });

		// the array that will hold all of the currently selected schools
		var selectedSchools = [];

		// takes the array of strings from 'selectedSchools' and returns it
		// as a single string with newlines
		function createString()
		{
			// the string we will be adding on to
			var arr;

			// loop through the array of strings
			$.each(selectedSchools, 
				function(i, v)
				{
					// for the first time just add the first string
					if (arr === undefined)
					{
						arr = v + "\n";
					}
					// for every other time add the rest 
					else
					{
						arr = arr + v + "\n";
					}
				}
			);
			return arr;
		}

	    // add event handlers to the add button
	    $("#addBtn").click(
	    	function()
	    	{
	    		// get the selected value and turn it to a string
	    		var schoolType = $("#multiselect").val().toString();

	    		// check to see if the selected value is already in the array
	    		if (selectedSchools.indexOf(schoolType) === -1)
	    		{
	    			// if the selected value is not in the array,
	    			// add it to the array and then add it to the text area

	    			selectedSchools.push(schoolType);

	    			$("#txtbox").val(createString());
	    		}
	    	}
	    );

	    // add event handlers to the remove button
	    $("#rmvBtn").click(
	    	function()
	    	{
	    		// get the selected value and turn it to a string
	    		var schoolType = $("#multiselect").val().toString();

	    		// find the index if it is in the array
	    		var index = selectedSchools.indexOf(schoolType);
	    		
	    		// if it is in the array, remove it
	    		if (index > -1)
	    		{
	    			// remove the value from the array
	    			selectedSchools.splice(index, 1);

	    			// clear the text area
	    			$("#txtbox").val("");

	    			// refill the text area
	    			$("#txtbox").val(createString());
	    		}
	    	}
	    );

	    // clears the selected schools array and the text area
	    function clear()
	    {
	    	// clear the text area
	    	$("#txtbox").val("");

    		// empty the array
    		selectedSchools = [];
	    }

	    // add event handlers to the clear button
	    $("#clrBtn").click(clear);

	    // add event handlers to the search 'SUBMIT' button
    	$("#submitBtn").click(
			function()
			{
				// add the functionality to go to the map screen
				$(sScreen).toggleClass("inactiveScreen");
		    	$(mScreen).toggleClass("inactiveScreen");

		    	// create the map with markers
				initMap();
			}
		);
    	//-------------------------------------------------------------------------------

    	// Map Stuff
    	//-------------------------------------------------------------------------------

    	// add event handlers to the map 'New Search' button
    	$("#newBtn").click(
			function()
			{
				// add the functionality to go to the search screen
				$(mScreen).toggleClass("inactiveScreen");
		    	$(sScreen).toggleClass("inactiveScreen");

		    	clear();
			}
		);

		/*
			School Type 				Color 			Hex
			===================================================
			Career academy 				red: 			#FF0000
			Charter						orange: 		#FF7F00
			Citywide-Option				yellow: 		#FFFF00
			Classical					blue: 			#0000FF
			Contract					violet: 		#9400D3
			Magnet 						white: 			#FFFFFF
			Military academy			black: 			#000000
			Neighborhood				aqua: 			#00FFFF
			Regional gifted center		pink: 			#FF99FF
			Selective enrollment		brown: 			#663300
			Small						dark green: 	#006600
			Special Education			light green: 	#66ff66
	    */
	    colors = 
    	{
    		"Career academy": "#FF0000",
    		"Charter": "#FF7F00",
    		"Citywide-Option": "#FFFF00",
    		"Classical": "#0000FF",
    		"Contract": "#9400D3",
    		"Magnet": "#FFFFFF",
    		"Military academy": "#000000",
    		"Neighborhood": "#00FFFF",
    		"Regional gifted center": "#FF99FF",
    		"Selective enrollment": "#663300",
    		"Small": "#006600",
    		"Special Education": "#66ff66"
    	};

    	// the variable that is the map
    	var map;

    	// add the map to the map screen inside the div with id 'map'
    	function initMap() 
    	{
	        var chicago = {lat: 41.8781, lng: -87.6298};
	        map = new google.maps.Map(document.getElementById("map"), 
	        {
	          zoom: 10,
	          center: chicago
        	});

	        getData();
	    }

	    // creates a string filled with content to add to the info window
	    function getContentString(v)
	    {
			var contentString = 
				'<div id="content" class="black">'+
					'<h1 id="firstHeading" class="firstHeading">' + v.long_name + '</h1>'+
					'<div id="bodyContent">'+
						'<p>' + v.summary + '</p>'+
						'<p><strong>Rating Status:</strong> ' + v.rating_status + '</p>'+
						'<p>' + v.rating_statement + '</p>'+
						'<p><strong>Graduation Rate:</strong> ' + v.graduation_rate_school + '</p>'+
						'<p><strong>Grades Offered:</strong>' + v.grades_offered + '</p>'+
						'<p><strong>Address:</strong> ' + v.address + '</p>'+
						'<p><strong>Phone:</strong> ' + v.phone + '</p>'+
						'<p><a href=' +v.school_website +'>' + 'School Website</a></p>'+
					'</div>'+
				'</div>';

				return contentString;
	    }

	    // creates and executes the AJAX call to retrieve the data for the specified schools
	    function getData()
	    {
	    	var url = "https://data.cityofchicago.org/resource/76dk-7ieb.json?$where=school_type IN ";

	    	var query = createQuery();

	    	if (query === undefined)
	    		return;

	    	url += query;

	    	$.ajax(
		    {
		    	// the url for requesting school type data from the api
		        url: url,
		        method: 'GET',
		     }).done(function(response) 
			    {
			    	loadData(response);

			    }).fail(function(err) 
				   {
				   		throw err;
			       });
	    }

	    // takes the data that was retrieved from the AJAX call as a parameter and 
	    // adds the data to a marker on the map
	    function loadData(data)
	    {
	    	$.each(data, function(i, v)
				{
					var latitude = parseFloat(v.school_latitude);
					var longitude = parseFloat(v.school_longitude);
					var name = v.long_name;
					var type = v.school_type;
					var color = colors[type];
					var contentString = getContentString(v);

					// create the marker for this school
					var marker = new google.maps.Marker(
						{
							position: {lat: latitude, lng: longitude},
							map: map,
							title: name,
							icon: 
							{
						        path: google.maps.SymbolPath.BACKWARD_CLOSED_ARROW,
						        scale: 5.5,
						        fillColor: color,
						        fillOpacity: 1.0,
						        strokeWeight: 0.4
						    }
						}
					);

					// create the info window for this school
			        var infowindow = new google.maps.InfoWindow(
				        {
				          content: contentString
				        }
				    );

			        // add a listener to the marker to display the info window when clicked
			        marker.addListener('click', function() 
			        {
			          infowindow.open(map, marker);
			        });
				}
			);
	    }

	    // creates and returns the ending part of the AJAX call query that has the list of school types
    	function createQuery()
	    {
	    	var arr;

	    	if (selectedSchools.length === 0)
	    		return arr;

	    	$.each(selectedSchools, function(i, v)
			{
				// for the first time
				if (arr === undefined)
				{
					arr = "('" + v + "'";
				}
				// every other time
				else
				{
					arr = arr + ",'" + v + "'";
				}
			});

	    	// add the closing parentheses
	    	arr += ")";

			return arr;
	    }
	    //-------------------------------------------------------------------------------
    </script>
    <!-- Google Maps API -->
    <script async defer
    	src="https://maps.googleapis.com/maps/api/js?key=AIzaSyD0zHggstjz-FDhr9M8nHdzOxEa_5QCvnY&callback=initMap">
    </script>
</body>
</html>